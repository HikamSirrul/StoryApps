const CACHE_NAME="storyapp-v5",STATIC_ASSETS=["/StoryApps/","/StoryApps/index.html","/StoryApps/manifest.json","/StoryApps/app.bundle.js","/StoryApps/app.css","/StoryApps/icons/icon-192.png","/StoryApps/icons/icon-512.png","/StoryApps/images/logo.png"];self.addEventListener("install",(e=>{console.log("[SW] Installing..."),self.skipWaiting(),e.waitUntil(caches.open(CACHE_NAME).then((e=>e.addAll(STATIC_ASSETS))).catch((e=>{console.error("[SW] Failed caching:",e)})))})),self.addEventListener("activate",(e=>{console.log("[SW] Activating..."),e.waitUntil(caches.keys().then((e=>Promise.all(e.map((e=>{if(e!==CACHE_NAME)return console.log("[SW] Deleting old cache:",e),caches.delete(e)})))))),self.clients.claim()})),self.addEventListener("fetch",(e=>{const t=e.request;if("GET"!==t.method)return;const n=t.url.includes("dicoding.dev/v1"),s=new URL(t.url).origin!==self.location.origin;n||s||e.respondWith(caches.match(t).then((e=>e||fetch(t).then((e=>{if(!e||200!==e.status||"opaque"===e.type)return e;const n=e.clone();return caches.open(CACHE_NAME).then((e=>{new URL(t.url).origin===self.location.origin&&e.put(t,n)})),e})).catch((()=>"navigate"===t.mode?caches.match("/StoryApps/index.html").then((e=>e||new Response("<h1>Offline</h1>",{headers:{"Content-Type":"text/html"}}))):"image"===t.destination?caches.match("/StoryApps/images/logo.png").then((e=>e||caches.match("/StoryApps/icons/icon-192.png"))).then((e=>e||new Response("",{status:404,statusText:"Not Found"}))):new Response("",{status:404,statusText:"Not Found"}))))))})),self.addEventListener("push",(e=>{console.log("[SW] Push received");const t=e.data?e.data.json():{},n=t.title||"Notifikasi Baru",s={body:t.body||"Ada update dari Story App!",icon:"/StoryApps/icons/icon-192.png",badge:"/StoryApps/icons/icon-192.png"};e.waitUntil(self.registration.showNotification(n,s))}));